# @suspensive/react-dom - AI Context

## Package Purpose

DOM-specific utilities that leverage browser APIs like Intersection Observer. Browser-only features that work with React Suspense patterns.

## Key Components

### `<InView/>`

Wrapper using Intersection Observer API to detect when element enters viewport.

```typescript
<InView
  onChange={(inView, entry) => {
    if (inView) {
      console.log('Element is visible!')
    }
  }}
  threshold={0.5}
  rootMargin="10px"
>
  <MyComponent />
</InView>
```

**Props:**

- `onChange`: Callback when intersection state changes
- `threshold`: Visibility threshold (0-1)
- `rootMargin`: Margin around root
- `root`: Custom root element
- `triggerOnce`: Only trigger once

### `<FadeIn/>`

Fade-in animation when component enters viewport.

```typescript
<FadeIn duration={300}>
  <MyComponent />
</FadeIn>
```

## Important Notes

- Browser-only utilities (requires DOM APIs)
- Should be wrapped in `<ClientOnly>` for SSR apps
- Uses Intersection Observer API (requires polyfill for older browsers)
- Optimized for performance with lazy observation

## Common Patterns

### With SSR Safety

```typescript
import { ClientOnly } from '@suspensive/react'
import { InView } from '@suspensive/react-dom'

<ClientOnly>
  <InView onChange={(inView) => console.log(inView)}>
    <Component />
  </InView>
</ClientOnly>
```

### Lazy Loading Images

```typescript
<InView triggerOnce>
  {({ inView }) =>
    inView ? <img src="large.jpg" /> : <div>Loading...</div>
  }
</InView>
```

### Tracking Visibility

```typescript
const [isVisible, setIsVisible] = useState(false)

<InView onChange={(inView) => setIsVisible(inView)}>
  <Component />
</InView>
```

## File Structure

- `src/InView.tsx` - InView component
- `src/FadeIn.tsx` - FadeIn component
- Tests co-located with components

## Browser Compatibility

- Modern browsers with Intersection Observer support
- For older browsers, requires Intersection Observer polyfill
- Falls back gracefully when API not available

## Performance Considerations

- Uses passive observers for scroll performance
- Automatically disconnects observers when unmounted
- Efficient for tracking multiple elements
