import { Callout } from '@/components'

# lazy

<Callout type='experimental'>

`lazy` is an experimental feature, so this interface may change.

</Callout>

The `lazy` function is a wrapper around React's `lazy` function that provides callbacks for component loading success and failure. It allows you to execute custom logic when a component loads successfully or fails, providing better user experience and debugging capabilities.

## Basic Usage

```tsx
import { lazy } from '@suspensive/react'

const MyComponent = lazy(() => import('./MyComponent'))
```

By default, `lazy` works the same as React's `lazy` but provides an additional `load` method.

## How it Works

1. **On Success**: When a component loads successfully, the `onSuccess` callback is called
2. **On Failure**: When a component fails to load, the `onError` callback is called
3. **Preloading**: You can use the `load` method to preload a component without rendering it

## Behavior

- **Success**: Component loads normally, just like `React.lazy`
- **Failure**: Error is thrown, allowing your error boundary to handle it
- **Callbacks**: Custom logic can be executed at success/failure points

## Examples

### Basic Component Loading

```tsx
import { lazy, Suspense, ErrorBoundary } from '@suspensive/react'

const UserProfile = lazy(() => import('./UserProfile'))

function App() {
  return (
    <ErrorBoundary fallback={<div>Something went wrong</div>}>
      <Suspense fallback={<div>Loading...</div>}>
        <UserProfile />
      </Suspense>
    </ErrorBoundary>
  )
}
```

### Success/Error Callbacks

#### Success Callback

```tsx
import { lazy, Suspense, ErrorBoundary } from '@suspensive/react'

const UserProfile = lazy(() => import('./UserProfile'), {
  onSuccess: () => console.log('UserProfile component loaded successfully'),
})

function App() {
  return (
    <ErrorBoundary fallback={<div>Something went wrong</div>}>
      <Suspense fallback={<div>Loading...</div>}>
        <UserProfile />
      </Suspense>
    </ErrorBoundary>
  )
}
```

#### Error Callback

```tsx
import { lazy, Suspense, ErrorBoundary } from '@suspensive/react'

const UserProfile = lazy(() => import('./UserProfile'), {
  onError: ({ error }) => {
    console.error('UserProfile loading failed:', error)
    // Additional error handling logic
  },
})

function App() {
  return (
    <ErrorBoundary fallback={<div>Something went wrong</div>}>
      <Suspense fallback={<div>Loading...</div>}>
        <UserProfile />
      </Suspense>
    </ErrorBoundary>
  )
}
```

### Preloading Components

```tsx
import { lazy, Suspense } from '@suspensive/react'

const Component = lazy(() => import('./Component'))

function PreloadExample() {
  const handlePreload = () => {
    Component.load() // Preload the component
  }

  return (
    <div>
      <button onClick={handlePreload}>Preload Component</button>
      <Suspense fallback={<div>Loading...</div>}>
        <Component />
      </Suspense>
    </div>
  )
}
```

### Custom Lazy Factory

```tsx
import { lazy } from '@suspensive/react'

// Custom lazy factory with default success/error callbacks
const customLazy = lazy.create({
  onSuccess: () => console.log('Component loaded successfully'),
  onError: ({ error }) => console.error('Component loading failed:', error),
})

const HeavyComponent = customLazy(() => import('./HeavyComponent'))
// Override default callbacks for this specific component
const LightComponent = customLazy(() => import('./LightComponent'), {
  onSuccess: () => console.log('LightComponent loaded'),
  onError: ({ error }) => {
    console.error('LightComponent loading failed:', error)
    // Special error handling logic
  },
})

function App() {
  return (
    <div>
      <HeavyComponent />
      <LightComponent />
    </div>
  )
}
```
