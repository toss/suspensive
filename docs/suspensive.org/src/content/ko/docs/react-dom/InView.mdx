import { Callout, Sandpack } from '@/components'

# InView

IntersectionObserverë¥¼ í™œìš©í•´ì„œ ë·°í¬íŠ¸ë‚´ì— ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤.

```tsx
import { PrefetchQuery } from '@suspensive/react-query'
import { InView } from '@suspensive/react-dom'

const PostsPage = ({ posts }: { posts: Post[] }) => (
  <div>
    <h1>Posts</h1>
    {posts.map((post) => (
      <InView triggerOnce>
        {({ ref, isInView }) => (
          <div ref={ref}>
            {isInView ? (
              // ğŸš« React hookì˜ ì œì•½ìœ¼ë¡œ usePrefetchQueryë¥¼ ì‚¬ìš©í•˜ì§€ ëª»í•©ë‹ˆë‹¤
              // usePrefetchQuery({
              //   queryKey: ['posts', post.id, 'comments'],
              //   queryFn: () => getPostComments(post.id),
              // })

              // âœ… Post Comments í˜ì´ì§€ì— ë“¤ì–´ê°€ê¸° ì „ì— ê°ê°ì˜ post comments queryì— ëŒ€í•´ usePrefetchQueryë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
              <PrefetchQuery
                queryKey={['posts', post.id, 'comments']}
                queryFn={() => getPostComments(post.id)}
              />
            ) : null}
            <h2>{post.title}</h2>
            <p>{post.description}</p>
            <Link to={`/posts/${post.id}/comments`}>See comments</Link>
          </div>
        )}
      </InView>
    ))}
  </div>
)
```

## props.onInView, onInViewEnd

`onInView`ëŠ” ìš”ì†Œê°€ ë·°í¬íŠ¸ì— ë“¤ì–´ì˜¬ ë•Œ í˜¸ì¶œë˜ëŠ” ì½œë°± í•¨ìˆ˜ì…ë‹ˆë‹¤.
`onInViewEnd`ëŠ” ìš”ì†Œê°€ ë·°í¬íŠ¸ì—ì„œ ë‚˜ê°ˆ ë•Œ í˜¸ì¶œë˜ëŠ” ì½œë°± í•¨ìˆ˜ì…ë‹ˆë‹¤.

<Sandpack>

```tsx Example.tsx active
import { InView } from '@suspensive/react-dom'
import { useState } from 'react'

export const Example = () => {
  const [inViewIndexes, setInViewIndexes] = useState([])
  return (
    <>
      {Array.from({ length: 100 }).map((_, index) => (
        <InView
          onInView={() => setInViewIndexes((prev) => [...prev, index])}
          onInViewEnd={() =>
            setInViewIndexes((prev) => prev.filter((i) => i !== index))
          }
        >
          {({ ref, isInView }) => (
            <div
              key={index}
              ref={ref}
              style={{
                backgroundColor: isInView ? 'lightblue' : 'orange',
                border: '1px solid',
                padding: 50,
                textAlign: 'center',
              }}
            >
              {isInView ? 'In View' : 'Out of View'}
            </div>
          )}
        </InView>
      ))}
      <div style={{ position: 'fixed', top: 0, backgroundColor: 'red' }}>
        inViewIndexes: {inViewIndexes.join(', ')}
      </div>
    </>
  )
}
```

</Sandpack>

## props.threshold

`threshold`ëŠ” IntersectionObserverì˜ thresholdë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.

<Sandpack>

```tsx Example.tsx active
import { InView } from '@suspensive/react-dom'

export const Example = () =>
  Array.from({ length: 100 }).map((_, index) => (
    <InView threshold={0.5}>
      {({ ref, isInView }) => (
        <div
          key={index}
          ref={ref}
          style={{
            backgroundColor: isInView ? 'lightblue' : 'orange',
            border: '1px solid',
            padding: 50,
            textAlign: 'center',
          }}
        >
          {isInView ? 'In View' : 'Out of View'}
        </div>
      )}
    </InView>
  ))
```

</Sandpack>

## props.triggerOnce

`triggerOnce`ëŠ” `true`ë¡œ ì„¤ì •í•˜ë©´, ë·°í¬íŠ¸ì— ë“¤ì–´ì˜¨ í›„ì—ëŠ” ë” ì´ìƒ triggerí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê¸°ë³¸ê°’ì€ `false`ì…ë‹ˆë‹¤.

<Sandpack>

```tsx Example.tsx active
import { InView } from '@suspensive/react-dom'

export const Example = () =>
  Array.from({ length: 100 }).map((_, index) => (
    <InView triggerOnce>
      {({ ref, isInView }) => (
        <div
          key={index}
          ref={ref}
          style={{
            backgroundColor: isInView ? 'lightblue' : 'orange',
            border: '1px solid',
            padding: 50,
            textAlign: 'center',
          }}
        >
          {isInView ? 'In View' : 'Out of View'}
        </div>
      )}
    </InView>
  ))
```

</Sandpack>

## props.skip

`skip`ëŠ” `true`ë¡œ ì„¤ì •í•˜ë©´, IntersectionObserverë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê¸°ë³¸ê°’ì€ `false`ì…ë‹ˆë‹¤.

<Sandpack>

```tsx Example.tsx active
import { Delay } from '@suspensive/react'
import { InView } from '@suspensive/react-dom'

export const Example = () => (
  <Delay ms={2000}>
    {({ isDelayed }) => (
      <div>
        <h1>skip: {isDelayed ? 'true' : 'false'}</h1>
        {Array.from({ length: 100 }).map((_, index) => (
          <InView skip={isDelayed}>
            {({ ref, isInView }) => (
              <div
                key={index}
                ref={ref}
                style={{
                  backgroundColor: isInView ? 'lightblue' : 'orange',
                  border: '1px solid',
                  padding: 50,
                  textAlign: 'center',
                }}
              >
                {isInView ? 'In View' : 'Out of View'}
              </div>
            )}
          </InView>
        ))}
      </div>
    )}
  </Delay>
)
```

</Sandpack>

## props.delay

`delay`ëŠ” IntersectionObserverì˜ delayë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. ê¸°ë³¸ê°’ì€ `0`ì…ë‹ˆë‹¤.

<Sandpack>

```tsx Example.tsx active
import { InView } from '@suspensive/react-dom'

export const Example = () =>
  Array.from({ length: 100 }).map((_, index) => (
    <InView delay={500}>
      {({ ref, isInView }) => (
        <div
          key={index}
          ref={ref}
          style={{
            backgroundColor: isInView ? 'lightblue' : 'orange',
            border: '1px solid',
            padding: 50,
            textAlign: 'center',
          }}
        >
          {isInView ? 'In View' : 'Out of View'}
        </div>
      )}
    </InView>
  ))
```

</Sandpack>
